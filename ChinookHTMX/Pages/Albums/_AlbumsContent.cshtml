@model ChinookHTMX.Pages.Albums.IndexModel

<!-- Begin Page Content -->
<div class="container-fluid">
    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h4 class="m-0 font-weight-bold text-primary">Albums</h4>
        </div>
        <div class="card-body">
            <div class="row mb-3">
                <div class="col-md-6">
                    <button hx-get="@Url.PageLink("Create")"
                            hx-target="#modal"
                            hx-swap="innerHTML"
                            class="btn btn-primary btn-icon-split">
                        <span class="icon text-white-50">
                            <i class="fas fa-plus"></i>
                        </span>
                        <span class="text">Create New Album</span>
                    </button>
                </div>
                <div class="col-md-6">
                    <div class="input-group">
                        <input type="text"
                               class="form-control"
                               placeholder="Search albums..."
                               name="searchTerm"
                               value="@Model.SearchTerm"
                               hx-get="@Url.Page("Index")"
                               hx-target="#albums-table-container"
                               hx-trigger="input changed delay:300ms, search"
                               hx-indicator="#search-indicator" />
                        <div class="input-group-append">
                            <span class="input-group-text">
                                <i id="search-indicator" class="fas fa-search htmx-indicator"></i>
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <div id="albums-table-container">
                @await Html.PartialAsync("_AlbumsTable", Model)
            </div>
        </div>
    </div>
</div>
<!-- /.container-fluid -->

<script>
    document.body.addEventListener('refreshTable', function(event) {
        htmx.ajax('GET', '@Url.Page("Index")', {target: '#albums-table-container'});
    });
</script>